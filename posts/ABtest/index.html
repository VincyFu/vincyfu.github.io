<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Project: Mobile Games A/B Testing with Cookie Cats" /><meta name="author" content="Rao" /><meta property="og:locale" content="en" /><meta name="description" content="1. Of cats and cookies Cookie Cats is a hugely popular mobile puzzle game developed by Tactile Entertainment. It’s a classic “connect three”-style puzzle game where the player must connect tiles of the same color to clear the board and win the level. It also features singing cats." /><meta property="og:description" content="1. Of cats and cookies Cookie Cats is a hugely popular mobile puzzle game developed by Tactile Entertainment. It’s a classic “connect three”-style puzzle game where the player must connect tiles of the same color to clear the board and win the level. It also features singing cats." /><link rel="canonical" href="https://vincyfu.github.io/posts/ABtest/" /><meta property="og:url" content="https://vincyfu.github.io/posts/ABtest/" /><meta property="og:site_name" content="Rao Fu" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-14T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Project: Mobile Games A/B Testing with Cookie Cats" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Rao" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Rao"},"dateModified":"2022-04-02T21:59:46+01:00","datePublished":"2022-01-14T00:00:00+00:00","description":"1. Of cats and cookies Cookie Cats is a hugely popular mobile puzzle game developed by Tactile Entertainment. It’s a classic “connect three”-style puzzle game where the player must connect tiles of the same color to clear the board and win the level. It also features singing cats.","headline":"Project: Mobile Games A/B Testing with Cookie Cats","mainEntityOfPage":{"@type":"WebPage","@id":"https://vincyfu.github.io/posts/ABtest/"},"url":"https://vincyfu.github.io/posts/ABtest/"}</script><title>Project: Mobile Games A/B Testing with Cookie Cats | Rao Fu</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rao Fu"><meta name="application-name" content="Rao Fu"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/Images/DSC01409.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rao Fu</a></div><div class="site-subtitle font-italic">LBS 2021 | PKU 2017</div></div><ul class="w-100"><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href=" javascript:location.href = 'mailto:' + ['vincyfu0423','gmail.com'].join('@')" aria-label="email" class="order-3" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/raofu0423/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Blogs </a> </span> <span>Project: Mobile Games A/B Testing with Cookie Cats</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Project: Mobile Games A/B Testing with Cookie Cats</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Rao </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 14, 2022, 12:00 AM +0000" >Jan 14<i class="unloaded">2022-01-14T00:00:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Apr 2, 2022, 9:59 PM +0100" >Apr 2<i class="unloaded">2022-04-02T21:59:46+01:00</i> </span> </span></div></div><div class="post-content"><h1 id="1-of-cats-and-cookies">1. Of cats and cookies</h1><p>Cookie Cats is a hugely popular mobile puzzle game developed by Tactile Entertainment. It’s a classic “connect three”-style puzzle game where the player must connect tiles of the same color to clear the board and win the level. It also features singing cats.</p><p>As players progress through the levels of the game, they will occasionally encounter gates that force them to wait a non-trivial amount of time or make an in-app purchase to progress. In addition to driving in-app purchases, these gates serve the important purpose of giving players an enforced break from playing the game, hopefully resulting in that the player’s enjoyment of the game being increased and prolonged.</p><figure align="center"> <img data-proofer-ignore data-src="/Images/cat1.png" style="width:80%" /></figure><p>But where should the gates be placed? Initially the first gate was placed at level 30, but in this notebook we’re going to analyze an AB-test where we moved the first gate in Cookie Cats from level 30 to level 40. In particular, we will look at the impact on player retention. But before we get to that, a key step before undertaking any analysis is understanding the data.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1"># Importing pandas
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Reading in the data
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"datasets/cookie_cats.csv"</span><span class="p">)</span>

<span class="c1"># Showing the first few rows
</span><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><figure align="center"> <img data-proofer-ignore data-src="/Images/chart1.png" style="width:80%" /></figure><h1 id="2-the-ab-test-data">2. The AB-test data</h1><p>The data we have is from 90,189 players that installed the game while the AB-test was running. The variables are:</p><ul><li><code>userid</code> - a unique number that identifies each player.<li><code>version</code> - whether the player was put in the control group (<code>gate_30</code> - a gate at level 30) or the group with the moved gate (<code>gate_40</code> - a gate at level 40).<li><code>sum_gamerounds</code> - the number of game rounds played by the player during the first 14 days after install.<li><code>retention_1</code> - did the player come back and play <strong>1 day</strong> after installing?<li><code>retention_7</code> - did the player come back and play <strong>7 days</strong> after installing?</ul><p>When a player installed the game, he or she was randomly assigned to either <code>gate_30</code> or <code>gate_40</code>. As a sanity check, let's see if there are roughly the same number of players in each AB group.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Counting the number of players in each AB group.
</span><span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'userid'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>version
gate_30    44700
gate_40    45489
Name: userid, dtype: int64
</pre></table></code></div></div><h1 id="3-the-distribution-of-game-rounds">3. The distribution of game rounds</h1><p>It looks like there is roughly the same number of players in each group, nice!</p><p>The focus of this analysis will be on how the gate placement affects player retention, but just for fun: Let's plot the distribution of the number of game rounds players played during their first week playing the game.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1"># This command makes plots appear in the notebook
</span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="c1"># Counting the number of players for each number of gamerounds 
</span><span class="n">plot_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'sum_gamerounds'</span><span class="p">)[</span><span class="s">'userid'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># Plotting the distribution of players that played 0 to 100 game rounds
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"sum_gamerounds"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"userid"</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"hist"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"sum of gamerounds"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"User ID"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Text(0,0.5,'User ID')
</pre></table></code></div></div><figure align="center"> <img data-proofer-ignore data-src="/Images/notebook_5_1.png" style="width:80%" /></figure><h1 id="4-overall-1-day-retention">4. Overall 1-day retention</h1><p>In the plot above we can see that some players install the game but then never play it (0 game rounds), some players just play a couple of game rounds in their first week, and some get really hooked!</p><p>What we want is for players to like the game and to get hooked. A common metric in the video gaming industry for how fun and engaging a game is <em>1-day retention</em>: The percentage of players that comes back and plays the game <em>one day</em> after they have installed it. The higher 1-day retention is, the easier it is to retain players and build a large player base.</p><p>As a first step, let's look at what 1-day retention is overall.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># The % of users that came back the day after they installed
</span><span class="n">df</span><span class="p">[</span><span class="s">'retention_1'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s">'retention_1'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.4452095044850259
</pre></table></code></div></div><h1 id="5-1-day-retention-by-ab-group">5. 1-day retention by AB-group</h1><p>So, a little less than half of the players come back one day after installing the game. Now that we have a benchmark, let's look at how 1-day retention differs between the two AB-groups.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Calculating 1-day retention for each AB-group
</span><span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_1'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_1'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>version
gate_30    0.448188
gate_40    0.442283
Name: retention_1, dtype: float64
</pre></table></code></div></div><h1 id="6-should-we-be-confident-in-the-difference">6. Should we be confident in the difference?</h1><p>It appears that there was a slight decrease in 1-day retention when the gate was moved to level 40 (44.2%) compared to the control when it was at level 30 (44.8%). It's a small change, but even small changes in retention can have a large impact. But while we are certain of the difference in the data, how certain should we be that a gate at level 40 will be worse in the future?</p><p>There are a couple of ways we can get at the certainty of these retention numbers. Here we will use bootstrapping: We will repeatedly re-sample our dataset (with replacement) and calculate 1-day retention for those samples. The variation in 1-day retention will give us an indication of how uncertain the retention numbers are.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1"># Creating an list with bootstrapped means for each AB-group
</span><span class="n">boot_1d</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">boot_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_1'</span><span class="p">].</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">boot_1d</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">boot_mean</span><span class="p">)</span>
    
<span class="c1"># Transforming the list to a DataFrame
</span><span class="n">boot_1d</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boot_1d</span><span class="p">)</span>
    
<span class="c1"># A Kernel Density Estimate plot of the bootstrap distributions
</span><span class="n">boot_1d</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'kde'</span><span class="p">)</span>
</pre></table></code></div></div><figure align="center"> <img data-proofer-ignore data-src="/Images/notebook_11_1.png" style="width:80%" /></figure><h1 id="7-zooming-in-on-the-difference">7. Zooming in on the difference</h1><p>These two distributions above represent the bootstrap uncertainty over what the underlying 1-day retention could be for the two AB-groups. Just eyeballing this plot, we can see that there seems to be some evidence of a difference, albeit small. Let's zoom in on the difference in 1-day retention</p><p>(<em>Note that in this notebook we have limited the number of bootstrap replication to 500 to keep the calculations quick. In "production" we would likely increase this to a much larger number, say, 10 000.</em>)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># Adding a column with the % difference between the two AB-groups
</span><span class="n">boot_1d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">boot_1d</span><span class="p">[</span><span class="s">'gate_30'</span><span class="p">]</span> <span class="o">-</span> <span class="n">boot_1d</span><span class="p">[</span><span class="s">'gate_40'</span><span class="p">])</span> <span class="o">/</span>  <span class="n">boot_1d</span><span class="p">[</span><span class="s">'gate_40'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Ploting the bootstrap % difference
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">boot_1d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s">'kde'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"% difference in means"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Text(0.5,0,'% difference in means')
</pre></table></code></div></div><figure align="center"> <img data-proofer-ignore data-src="/Images/notebook_13_1.png" style="width:80%" /></figure><h1 id="8-the-probability-of-a-difference">8. The probability of a difference</h1><p>From this chart, we can see that the most likely % difference is around 1% - 2%, and that most of the distribution is above 0%, in favor of a gate at level 30. But what is the <em>probability</em> that the difference is above 0%? Let's calculate that as well.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># Calculating the probability that 1-day retention is greater when the gate is at level 30
</span><span class="n">prob</span> <span class="o">=</span> <span class="p">(</span><span class="n">boot_1d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">boot_1d</span><span class="p">)</span>

<span class="c1"># Pretty printing the probability
</span><span class="s">'{:.1%}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>'97.6%'
</pre></table></code></div></div><h1 id="9-7-day-retention-by-ab-group">9. 7-day retention by AB-group</h1><p>The bootstrap analysis tells us that there is a high probability that 1-day retention is better when the gate is at level 30. However, since players have only been playing the game for one day, it is likely that most players haven't reached level 30 yet. That is, many players won't have been affected by the gate, even if it's as early as level 30.</p><p>But after having played for a week, more players should have reached level 40, and therefore it makes sense to also look at 7-day retention. That is: What percentage of the people that installed the game also showed up a week later to play the game again.</p><p>Let's start by calculating 7-day retention for the two AB-groups.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Calculating 7-day retention for both AB-groups
</span><span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_7'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_7'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>version
gate_30    0.190201
gate_40    0.182000
Name: retention_7, dtype: float64
</pre></table></code></div></div><h1 id="10-bootstrapping-the-difference-again">10. Bootstrapping the difference again</h1><p>Like with 1-day retention, we see that 7-day retention is slightly lower (18.2%) when the gate is at level 40 than when the gate is at level 30 (19.0%). This difference is also larger than for 1-day retention, presumably because more players have had time to hit the first gate. We also see that the <em>overall</em> 7-day retention is lower than the <em>overall</em> 1-day retention; fewer people play a game a week after installing than a day after installing.</p><p>But as before, let's use bootstrap analysis to figure out how certain we should be of the difference between the AB-groups.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1"># Creating a list with bootstrapped means for each AB-group
</span><span class="n">boot_7d</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">boot_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">groupby</span><span class="p">(</span><span class="s">'version'</span><span class="p">)[</span><span class="s">'retention_7'</span><span class="p">].</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">boot_7d</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">boot_mean</span><span class="p">)</span>
    
<span class="c1"># Transforming the list to a DataFrame
</span><span class="n">boot_7d</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boot_7d</span><span class="p">)</span>

<span class="c1"># Adding a column with the % difference between the two AB-groups
</span><span class="n">boot_7d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">boot_7d</span><span class="p">[</span><span class="s">'gate_30'</span><span class="p">]</span> <span class="o">-</span> <span class="n">boot_7d</span><span class="p">[</span><span class="s">'gate_40'</span><span class="p">])</span> <span class="o">/</span>  <span class="n">boot_7d</span><span class="p">[</span><span class="s">'gate_40'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Ploting the bootstrap % difference
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">boot_7d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s">'kde'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"% difference in means"</span><span class="p">)</span>

<span class="c1"># Calculating the probability that 7-day retention is greater when the gate is at level 30
</span><span class="n">prob</span> <span class="o">=</span> <span class="p">(</span><span class="n">boot_7d</span><span class="p">[</span><span class="s">'diff'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">boot_7d</span><span class="p">)</span>

<span class="c1"># Pretty printing the probability
</span><span class="s">'{:.1%}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="11--the-conclusion">11. The conclusion</h2><p>The bootstrap result tells us that there is strong evidence that 7-day retention is higher when the gate is at level 30 than when it is at level 40. The conclusion is: If we want to keep retention high — both 1-day and 7-day retention — we should <strong>not</strong> move the gate from level 30 to level 40. There are, of course, other metrics we could look at, like the number of game rounds played or how much in-game purchases are made by the two AB-groups. But retention <em>is</em> one of the most important metrics. If we don't retain our player base, it doesn't matter how much money they spend in-game.</p><p><img data-proofer-ignore data-src="https://assets.datacamp.com/production/project_184/img/cookie_yellow.png" style="width:100px; float:center" /></p><p>So, why is retention higher when the gate is positioned earlier? One could expect the opposite: The later the obstacle, the longer people are going to engage with the game. But this is not what the data tells us. The theory of <em>hedonic adaptation</em> can give one explanation for this. In short, hedonic adaptation is the tendency for people to get less and less enjoyment out of a fun activity over time if that activity is undertaken continuously. By forcing players to take a break when they reach a gate, their enjoyment of the game is prolonged. But when the gate is moved to level 40, fewer players make it far enough, and they are more likely to quit the game because they simply got bored of it.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># So, given the data and the bootstrap analysis
# Should we move the gate from level 30 to level 40 ?
</span><span class="n">move_to_level_40</span> <span class="o">=</span> <span class="bp">False</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-analytics/'>Data Analytics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/game/" class="post-tag no-text-decoration" >Game</a> <a href="/tags/a-b-test/" class="post-tag no-text-decoration" >A/B Test</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Project: Mobile Games A/B Testing with Cookie Cats - Rao Fu&url=https://vincyfu.github.io/posts/ABtest/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Project: Mobile Games A/B Testing with Cookie Cats - Rao Fu&u=https://vincyfu.github.io/posts/ABtest/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Project: Mobile Games A/B Testing with Cookie Cats - Rao Fu&url=https://vincyfu.github.io/posts/ABtest/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ABtest/">Project: Mobile Games A/B Testing with Cookie Cats</a><li><a href="/posts/TableauTest/">How did COVID-19 pandemic affect the London house market?</a><li><a href="/posts/Alchemystars/">《白夜极光》游戏分析报告</a><li><a href="/posts/discoelysium/">《极乐迪斯科》：献给痛苦的龙舌兰日落</a><li><a href="/posts/educationphilosophy/">《死亡诗社》影评：灵魂的上升与危险</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a> <a class="post-tag" href="/tags/%E8%89%BA%E6%9C%AF%E5%93%B2%E5%AD%A6/">艺术哲学</a> <a class="post-tag" href="/tags/a-b-test/">A/B Test</a> <a class="post-tag" href="/tags/game/">Game</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/tableau/">Tableau</a> <a class="post-tag" href="/tags/%E6%AD%BB%E4%BA%A1%E8%AF%97%E7%A4%BE/">《死亡诗社》</a> <a class="post-tag" href="/tags/%E6%94%BF%E6%B2%BB%E5%93%B2%E5%AD%A6/">政治哲学</a> <a class="post-tag" href="/tags/%E6%95%99%E8%82%B2%E5%93%B2%E5%AD%A6/">教育哲学</a> <a class="post-tag" href="/tags/%E6%9E%81%E4%B9%90%E8%BF%AA%E6%96%AF%E7%A7%91/">极乐迪斯科</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/TableauTest/"><div class="card-body"> <span class="timeago small" >Apr 2<i class="unloaded">2022-04-02T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How did COVID-19 pandemic affect the London house market?</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/Alchemystars/"><div class="card-body"> <span class="timeago small" >Feb 28<i class="unloaded">2022-02-28T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《白夜极光》游戏分析报告</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/discoelysium/"><div class="card-body"> <span class="timeago small" >Dec 23, 2021<i class="unloaded">2021-12-23T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《极乐迪斯科》：献给痛苦的龙舌兰日落</h3><div class="text-muted small"><p> 1 游戏机制 作为跑团爱好者去玩《极乐迪斯科》（Disco Elysium）无疑是亲切的，尽管类似TRPG（Tabletop role-playing game）的跑团玩法只是《极乐迪斯科》最表层的体验。 《极乐迪斯科》被称为CRPG的里程碑，但其在玩法上的颠覆性在于背离了CRPG以往的范式，牺牲了策略、操作与战斗，引入类似TRPG的判定模式，并重视价值的塑造、角色扮演的沉浸感，同时通过...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/discoelysium/" class="btn btn-outline-primary" prompt="Older"><p>《极乐迪斯科》：献给痛苦的龙舌兰日落</p></a> <a href="/posts/Alchemystars/" class="btn btn-outline-primary" prompt="Newer"><p>《白夜极光》游戏分析报告</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/raofu0423/">Rao Fu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a> <a class="post-tag" href="/tags/%E8%89%BA%E6%9C%AF%E5%93%B2%E5%AD%A6/">艺术哲学</a> <a class="post-tag" href="/tags/a-b-test/">A/B Test</a> <a class="post-tag" href="/tags/game/">Game</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/tableau/">Tableau</a> <a class="post-tag" href="/tags/%E6%AD%BB%E4%BA%A1%E8%AF%97%E7%A4%BE/">《死亡诗社》</a> <a class="post-tag" href="/tags/%E6%94%BF%E6%B2%BB%E5%93%B2%E5%AD%A6/">政治哲学</a> <a class="post-tag" href="/tags/%E6%95%99%E8%82%B2%E5%93%B2%E5%AD%A6/">教育哲学</a> <a class="post-tag" href="/tags/%E6%9E%81%E4%B9%90%E8%BF%AA%E6%96%AF%E7%A7%91/">极乐迪斯科</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-7T64GSC06W"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-7T64GSC06W'); }); </script>
